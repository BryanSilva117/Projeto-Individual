<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./img/DCLOGO3.png">
    <title>Detective Comics Perfil</title>
    <link rel="stylesheet" href="./css/perfil.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:ital@1&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="./js/funcoes.js"></script>

</head>

<body>
    <!-- parte da lateral  -->

    <div class="inicio" id="inicio">

        <div class="lateral1" id="lateralI" style="margin-left: 0vh;">
            <div class="lateral">
                <div>
                    <h1>Seu Perfil</h1>
                    <br>
                    <a href="./hero.html">Voltar</a>
                    <br><br>
                </div>
                <br>
                <h1>Equipes DC</h1>
                <br>
                <br>

                <div>
                    <a href="#justice">Liga da Justiça</a>
                    <br>
                    <a href="#justiceSombira">Liga da Justisa Sombria</a>
                    <br>
                    <a href="#Sociedade">Sociedade da Justiça</a>
                    <br>
                    <a href="#JusticeJovem">Justiça Jovem</a>
                    <br>
                    <a href="#JovensTita">Jovens Titã</a>
                    <br>
                    <a href="#FamíliaMarvel">Família Marvel</a>
                    <br><br>
                    <h1>Vilões/Anti-Herois</h1>
                    <br>
                    <a href="#leagueIn">Liga da Injustiça</a>
                    <br>
                    <a href="#suicideScquade">Esquadrão Suicida</a>
                    <br><br>
                    <h1>Interação</h1>
                    <br>
                    <a href="./QuizP.html">Responder um Quiz</a>
                    <br>
                    <a href="./dashQuiz.html">Dashboard Quiz</a>
                    <br>
                    <a href="./DashPerso.html">Dash Herois JL Pref</a>
                    <br><br>

                </div>
            </div>
        </div>

        <div class="capa">
            <div id="imgPerfil">
                <img class="imgPerfil" src="./img/nadaPerfil.png" alt="">
            </div>
        </div>



        <div class="biografia" id="mostrarB">

            <textarea class="textB" id="biografiaA" placeholder="Digite Sua Bibliografia" maxlength="40"></textarea>
            <br>
            <button onclick="enviarB()">concluir</button>

        </div>
        <div class="botoesED">
            <button onclick="editar()" class="editar">Editar</button>
            <button onclick="excluir()" class="deletar">Deletar Conta</button>
        </div>

        <div class="nomeSobr">

            <div id="div_nomeSo"></div>

        </div>
        <div class="email">
            <div>Email: <span id="span_email"></span></div>
            <br>
            <div>Gênero: <span id="span_genero"></span></div>
            <br>
            <div>Data de Nascimento: <span id="span_dataN"></span></div>
            <br>
            <div>Personagem Favorito: <span id="span_persoF"></span></div>
        </div>

        <!-- parano -->
        <div class="cadastro" id="editar" style="display: none;">
            <div class="logoCadastro">
                <img src="./img/DCLOGO3.png" alt="" width="80px">
            </div>
            <br>
            <br>

            <div class="alerta_erro">
                <div class="card_erro" id="cardErro">
                    <span id="mensagem_erro"></span>
                </div>
            </div>

            <div class="inputs">

                <input class="nome" placeholder="Nome*" id="nome_input">

                <input class="sobrenome" placeholder="Sobrenome" id="sobrenome_input">

            </div>

            <div class="inputs">

                <input class="emailE" placeholder="Email*" id="email_input" style="box-shadow: none">


            </div>



            <div class="inputs">

                <input class="dtNasc" type="date" placeholder="Nascimento" id="dtNasc_input">

                <select class="genero" name="genero" id="genero_input">
                    <option value="" disabled selected hidden>gênero</option>
                    <option value="Masculino">Masculino</option>
                    <option value="Feminino">Feminino</option>
                    <option value="Outro">Outro</option>
                    <option value="prefNd">Prefiro não dizer</option>

                </select>

            </div>

            <div class="escolha">

                Qual membro da Liga da Justiça Você prefere?

            </div>
            <div>

                <select class="heroPref" name="PersFav" id="personagemFav_input">
                    <option value="" disabled selected hidden>Escolher...</option>
                    <option value="1">Superman</option>
                    <option value="2">Batman</option>
                    <option value="3">Mulher Maravilha</option>
                    <option value="4">Flash</option>
                    <option value="5">Lanterna Verde</option>
                    <option value="6">Aquaman</option>
                    <option value="7">Ciborgue</option>
                    <option value="8">Outro</option>
                    <option value="9">Prefiro a Marvel</option>
                </select>

            </div>

            <div class="botao">
                <br>
                <br>
                <button onclick="cadastrar()"><b>Cadastrar</b></button>
            </div>

        </div>
</body>

<script>
    var nomeG;
    var sobrenomeG;
    var emailG;
    var generoG;
    var dataNG;
    var persoFG;







    var superman = [

        './img/supermanP/superman1.jpg',
        './img/supermanP/superman2.jpg',
        './img/supermanP/superman3.jpg',
        './img/supermanP/superman4.jpg',
        './img/supermanP/superman5.jpg',

    ]

    var batman = [
        './img/batmanP/batman1.jpg',
        './img/batmanP/batman2.jpg',
        './img/batmanP/batman3.jpg',
        './img/batmanP/batman4.jpg',
        './img/batmanP/batman5.jpg',
    ]

    var mulherM = [
        './img/wonderP/mulherM1.jpg',
        './img/wonderP/mulherM2.jpg',
        './img/wonderP/mulherM3.jpg',
        './img/wonderP/mulherM4.jpg',
        './img/wonderP/mulherM5.jpg',
    ]

    var flash = [
        './img/flashP/flash1.jpg',
        './img/flashP/flash2.jpg',
        './img/flashP/flash3.jpg',
        './img/flashP/flash4.jpg',
        './img/flashP/flash5.jpg',

    ]

    var lanternaV = [
        './img/lanternP/lanterna1.png',
        './img/lanternP/lanterna2.png',
        './img/lanternP/lanterna3.png',
        './img/lanternP/lanterna4.png',
        './img/lanternP/lanterna5.png',
    ]

    var aquaman = [
        './img/aquamanP/aquaman1.png',
        './img/aquamanP/aquaman2.png',
        './img/aquamanP/aquaman3.png',
        './img/aquamanP/aquaman4.png',
        './img/aquamanP/aquaman5.png',
    ]

    var ciborgue = [
        './img/ciborgueP/ciborgue1.jpg',
        './img/ciborgueP/ciborgue2.jpg',
        './img/ciborgueP/ciborgue3.jpg',
        './img/ciborgueP/ciborgue4.jpg',
        './img/ciborgueP/ciborgue5.jpg',
    ]


    var imgOutros = [
        './img/outroP/outro1.png',
        './img/outroP/outro2.png',
        './img/outroP/outro3.png',
        './img/outroP/outro4.png',
        './img/outroP/outro5.png',
        './img/outroP/outro6.png',
        './img/outroP/outro7.png',
        './img/outroP/outro8.png',
        './img/outroP/outro9.png',
        './img/outroP/outro10.png',
        './img/outroP/outro11.png',
        './img/outroP/outro12.png',
        './img/outroP/outro13.png',
    ]


    var marvel = [
        './img/marvelP/marvel1.jpg',
        './img/marvelP/marvel2.jpg',
        './img/marvelP/marvel3.jpg',
        './img/marvelP/marvel4.jpg',
        './img/marvelP/marvel5.jpg',
    ]



    // pedoro
    function enviarB() {
        var fkUsuario = sessionStorage.ID_USUARIO
        var biografia = biografiaA.value
        console.log('gggggggggggggggggggg' + fkUsuario)
        console.log('wwwwwwwwwwwwwwwwwww  ' + biografia)

        if (biografia == '') {
            alert('Digite sua Biografia')
        }
        else {

            // Enviando o valor da nova input
            fetch("/usuarios/biografia", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vá para o arquivo routes/usuario.js
                    biografiaServer: biografia,
                    fkUsuarioServer: fkUsuario

                })
            }).then(function (resposta) {

                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    plotarB()

                } else {
                    throw ("Houve um erro ao tentar realizar o cadastro!");
                }
            }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
                finalizarAguardar();
            });

            return false;
        }

    }

    window.onload = plotarB(1);

    function plotarB(idAquario) {
        var idAquario = sessionStorage.ID_USUARIO
        var descricaoB;


        fetch(`/usuarios/plotarB/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    for (var i = 0; i < resposta.length; i++) {
                        var registro = resposta[i];
                        descricaoB = (registro.descricao);
                    }
                    if (mostrarB != undefined) {

                        mostrarB.innerHTML = descricaoB

                    }

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }


    window.onload = fotosPerso(1);

    function fotosPerso(idAquario) {
        var idAquario = sessionStorage.ID_USUARIO
        var fkPerso;


        fetch(`/medidas/fotosPerso/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    for (var i = 0; i < resposta.length; i++) {
                        var registro = resposta[i];
                        fkPerso = (registro.personagem);
                    }

                    if (fkPerso == 1) {
                        var num = parseInt(Math.random() * superman.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${superman[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 2) {
                        var num = parseInt(Math.random() * batman.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${batman[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 3) {
                        var num = parseInt(Math.random() * mulherM.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${mulherM[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 4) {
                        var num = parseInt(Math.random() * flash.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${flash[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 5) {
                        var num = parseInt(Math.random() * lanternaV.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${lanternaV[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 6) {
                        var num = parseInt(Math.random() * aquaman.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${aquaman[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 7) {
                        var num = parseInt(Math.random() * ciborgue.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${ciborgue[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 8) {
                        var num = parseInt(Math.random() * imgOutros.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${imgOutros[num]}" alt=""
                     width="150px">`

                    }
                    if (fkPerso == 9) {
                        var num = parseInt(Math.random() * marvel.length)

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="${marvel[num]}" alt=""
                     width="150px">`

                    }

                    if (fkPerso == undefined) {

                        imgPerfil.innerHTML = `<img class="imgPerfil" src="./img/nadaPerfil.png" alt=""
                     width="150px">`
                    }



                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }

    window.onload = perfil(1);

    function perfil(idAquario) {
        var idAquario = sessionStorage.ID_USUARIO
        var nome;
        var sobrenome;
        var email;
        var genero;
        var dataN;
        var persoF;


        fetch(`/medidas/perfil/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    for (var i = 0; i < resposta.length; i++) {
                        var registro = resposta[i];
                        nome = (registro.NomeU);
                        sobrenome = (registro.sobrenome);
                        email = (registro.email);
                        genero = (registro.Genero);
                        dataN = (registro.dtNasc);
                        persoF = (registro.Personagem);
                    }


                    div_nomeSo.innerHTML = `${nome} ${sobrenome}`
                    span_email.innerHTML = email
                    span_genero.innerHTML = genero
                    span_dataN.innerHTML = dataN
                    span_persoF.innerHTML = persoF

                    var nomeG = nome
                    var sobrenomeG = sobrenome
                    var emailG = email
                    var generoG = genero
                    var dataNG = dataN
                    var persoFG = persoF



                });

            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }

    // parano
    function editar() {
        var sumir = document.getElementById('editar')
        if (sumir.style.display == 'none') {
            sumir.style.display = 'flex'
        }

        else {
            sumir.style.display = 'none'
        }

    }

    function deletar(idAquario) {
        var idAquario = sessionStorage.ID_USUARIO


        fetch(`/usuarios/deletar/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                console.log('biografia deletada')
                deletar1()
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }



    function deletar1(idAquario) {
        var idAquario = sessionStorage.ID_USUARIO

        fetch(`/usuarios/deletar1/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                console.log('quiz deletado')
                deletar2()
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }


    function deletar2(idAquario) {
        var idAquario = sessionStorage.ID_USUARIO

        fetch(`/usuarios/deletar2/${idAquario}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                console.log('usuario deletado')
                setTimeout(() => {
                    window.location = "index.html";
                }, "2000")
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }

    function excluir() {
        Swal.fire({
            title: 'Você tem certeza?',
            text: "Sua conta será apagada para sempre!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'SIM'
        }).then((result) => {
            if (result.isConfirmed) {
                deletar()
                Swal.fire(
                    'Deletado!',
                    'Sua conta Foi deletada',
                    'success'
                )
            }
        })
    }






</script>